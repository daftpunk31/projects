# -*- coding: utf-8 -*-
"""brain_stroke_prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Ln94pFbY9gG6mPUArNCxgprKfxa5d2VO
"""

from google.colab import files
uploaded=files.upload()

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn import metrics
import seaborn as sns
import pickle
from datetime import datetime
import datetime
from sklearn import preprocessing

data=pd.read_csv("enc_brain_stroke.csv")

data=data[["age","hypertension","heart_disease","avg_glucose_level","bmi","stroke","gender_Female","gender_Male","gender_Other","ever_married_No","ever_married_Yes","work_type_Govt_job","work_type_Never_worked","work_type_Private","work_type_Self-employed","work_type_children","Residence_type_Rural","Residence_type_Urban","smoking_status_Unknown","smoking_status_formerly smoked","smoking_status_never smoked","smoking_status_smokes"]]

print(data.info())

print(data.isnull().sum())
print()
print(data.shape)

'''
data.dropna(inplace=True)
print()
print(data.isnull().sum())
print()
print(data.shape)
'''

'''
one_hot_encoded_data=pd.get_dummies(data,columns=["gender","ever_married","work_type","Residence_type","smoking_status"])
edata=one_hot_encoded_data.copy()
edata.to_csv("enc_brain_stroke.csv")
'''

'''
files.download("enc_brain_stroke.csv")
'''

predictors=data.drop("stroke",axis=1)
target=data["stroke"]
X_train,X_test,Y_train,Y_test=train_test_split(predictors,target,test_size=0.20,random_state=0)

X_train.shape

X_test.shape

Y_train.shape

Y_test.shape

print(Y_test[211:530])

from sklearn.metrics import accuracy_score
from sklearn.linear_model import LogisticRegression
lr=LogisticRegression()
lr.fit(X_train,Y_train)
Y_pred_lr=lr.predict(X_test)
Y_pred_lr.shape
# print(Y_pred_lr,"\n")
score_lr=round(accuracy_score(Y_pred_lr,Y_test)*100,2)
print("The accuracy score achieved using Logistic Regression is:"+str(score_lr)+"%")